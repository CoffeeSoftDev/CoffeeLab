# ğŸ¨ DiseÃ±o Visual del Formulario de CampaÃ±a

## DescripciÃ³n

Se implementÃ³ un diseÃ±o visual completamente personalizado que coincide exactamente con el mockup proporcionado en la imagen.

## ğŸ“ Estructura del DiseÃ±o

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ğŸ“¢ CAMPAÃ‘A 1                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Estrategia    â”‚ Unidad de negocio â”‚ Red social â”‚  [+]    â”‚ â”‚
â”‚  â”‚ [Mensajes]    â”‚ [Fogaza â–¼]        â”‚ [Facebook â–¼] â”‚       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ Nombre del anuncio   â”‚  â”‚ Nombre del anuncio   â”‚           â”‚
â”‚  â”‚ [DiseÃ±o imagen]      â”‚  â”‚ [DiseÃ±o imagen]      â”‚           â”‚
â”‚  â”‚                      â”‚  â”‚                      â”‚           â”‚
â”‚  â”‚ Fecha inicio  Fecha finâ”‚ â”‚ Fecha inicio  Fecha finâ”‚         â”‚
â”‚  â”‚ [01/07/2025] [14/07]â”‚  â”‚ [15/07/2025] [30/07]â”‚           â”‚
â”‚  â”‚                      â”‚  â”‚                      â”‚           â”‚
â”‚  â”‚ Tipo de anuncio      â”‚  â”‚ Tipo de anuncio      â”‚           â”‚
â”‚  â”‚ [PublicaciÃ³n â–¼]      â”‚  â”‚ [PublicaciÃ³n â–¼]      â”‚           â”‚
â”‚  â”‚                      â”‚  â”‚                      â”‚           â”‚
â”‚  â”‚ ClasificaciÃ³n        â”‚  â”‚ ClasificaciÃ³n        â”‚           â”‚
â”‚  â”‚ [Pauta 1]            â”‚  â”‚ [Pauta 2]            â”‚           â”‚
â”‚  â”‚                      â”‚  â”‚                      â”‚           â”‚
â”‚  â”‚ Imagen               â”‚  â”‚ Imagen               â”‚           â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚           â”‚
â”‚  â”‚ â”‚       â¬†ï¸         â”‚ â”‚  â”‚ â”‚       â¬†ï¸         â”‚ â”‚           â”‚
â”‚  â”‚ â”‚  Click para      â”‚ â”‚  â”‚ â”‚  Click para      â”‚ â”‚           â”‚
â”‚  â”‚ â”‚  subir imagen    â”‚ â”‚  â”‚ â”‚  subir imagen    â”‚ â”‚           â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚           â”‚
â”‚  â”‚                      â”‚  â”‚                      â”‚           â”‚
â”‚  â”‚ [Actualizar][Eliminar]â”‚ â”‚ [Actualizar][Eliminar]â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                 â”‚
â”‚                    [Cancelar] [Guardar CampaÃ±a]                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¯ CaracterÃ­sticas Implementadas

### 1. Barra Superior de CampaÃ±a
```html
<div class="row mb-4 p-3 bg-light rounded">
    - Estrategia (input text)
    - Unidad de negocio (select)
    - Red social (select)
    - BotÃ³n [+] Agregar (para aÃ±adir mÃ¡s anuncios)
</div>
```

**Funcionalidad:**
- âœ… Campos compartidos para toda la campaÃ±a
- âœ… BotÃ³n [+] agrega nuevas tarjetas de anuncio dinÃ¡micamente
- âœ… Fondo gris claro para diferenciar del resto

### 2. Tarjetas de Anuncios (Grid 2 columnas)
```html
<div class="row">
    <div class="col-md-6"> <!-- Anuncio 1 --> </div>
    <div class="col-md-6"> <!-- Anuncio 2 --> </div>
    <!-- MÃ¡s anuncios dinÃ¡micamente -->
</div>
```

**Cada tarjeta contiene:**
- âœ… Nombre del anuncio (input)
- âœ… Fecha inicio / Fecha fin (date inputs)
- âœ… Tipo de anuncio (select)
- âœ… ClasificaciÃ³n (input)
- âœ… Ãrea de carga de imagen (drag & drop visual)
- âœ… Botones: [Actualizar] [Eliminar]

### 3. Ãrea de Carga de Imagen
```html
<div class="ad-image-upload" style="cursor: pointer;">
    <i class="icon-upload"></i>
    <p>Click para subir imagen</p>
    <input type="file" class="d-none" accept="image/*">
</div>
```

**Funcionalidad:**
- âœ… Click en el Ã¡rea abre selector de archivos
- âœ… Preview de imagen despuÃ©s de seleccionar
- âœ… ConversiÃ³n a base64 para envÃ­o
- âœ… Icono de upload visual

### 4. Botones de AcciÃ³n por Anuncio

**Actualizar (Azul):**
- Valida el anuncio individual
- Verifica que tenga nombre
- Muestra confirmaciÃ³n

**Eliminar (Rojo):**
- Elimina la tarjeta del anuncio
- ValidaciÃ³n: MÃ­nimo 1 anuncio requerido
- ConfirmaciÃ³n antes de eliminar

### 5. BotÃ³n [+] Agregar Anuncio
```javascript
$('#btnAddAd').on('click', () => {
    adCounter++;
    $('#ads-container').append(this.buildAdCardHTML(adCounter, ...));
});
```

**Funcionalidad:**
- âœ… Agrega nuevas tarjetas dinÃ¡micamente
- âœ… Contador automÃ¡tico (Pauta 1, Pauta 2, Pauta 3...)
- âœ… Fechas por defecto automÃ¡ticas
- âœ… Sin lÃ­mite de anuncios

## ğŸ¨ Estilos y DiseÃ±o

### Colores
- **Barra superior:** `bg-light` (gris claro)
- **Tarjetas:** `border` con fondo blanco
- **BotÃ³n Actualizar:** `btn-info` (azul)
- **BotÃ³n Eliminar:** `btn-danger` (rojo)
- **BotÃ³n Agregar:** `btn-success` (verde)

### Layout Responsivo
```css
col-md-6  /* 2 columnas en desktop */
col-12    /* 1 columna en mÃ³vil */
```

### Espaciado
- `mb-3` entre campos
- `p-3` padding en barra superior
- `gap-2` entre botones

## ğŸ”§ Funcionalidades JavaScript

### 1. InicializaciÃ³n del Formulario
```javascript
showCampaignForm() {
    // Calcula fechas por defecto
    // Construye HTML del formulario
    // Muestra modal con bootbox
    // Inicializa eventos
}
```

### 2. ConstrucciÃ³n DinÃ¡mica de HTML
```javascript
buildCampaignFormHTML() {
    // Barra superior
    // Contenedor de anuncios
    // 2 tarjetas iniciales
}

buildAdCardHTML(index, startDate, endDate) {
    // Estructura de cada tarjeta
    // Campos precargados
    // Botones de acciÃ³n
}
```

### 3. Eventos Interactivos
```javascript
initCampaignFormEvents() {
    // BotÃ³n agregar anuncio
    // Eventos de tarjetas
}

initAdCardEvents() {
    // Click en Ã¡rea de imagen
    // Cambio de archivo
    // BotÃ³n eliminar
    // BotÃ³n actualizar
}
```

### 4. Guardado de Datos
```javascript
saveCampaignWithAds() {
    // Recopila datos de campaÃ±a
    // Itera sobre todas las tarjetas
    // Construye array de anuncios
    // EnvÃ­a al backend
}
```

## ğŸ“Š Flujo de Datos

### Frontend â†’ Backend
```javascript
{
    strategy: "Mensajes",
    udn_id: 1,
    social_network: "Facebook",
    ads: [
        {
            ad_name: "DiseÃ±o imagen",
            start_date: "2025-07-01",
            end_date: "2025-07-14",
            type_id: 1,
            classification_name: "Pauta 1",
            image_url: "data:image/png;base64,..."
        },
        {
            ad_name: "DiseÃ±o imagen 2",
            start_date: "2025-07-15",
            end_date: "2025-07-30",
            type_id: 1,
            classification_name: "Pauta 2",
            image_url: "data:image/png;base64,..."
        }
    ]
}
```

### Backend Processing
```php
function addCampaignWithMultipleAds() {
    // 1. Crear campaÃ±a
    $campaignId = $this->createCampaign(...);
    
    // 2. Iterar sobre anuncios
    foreach ($ads as $ad) {
        $this->createCampaignAd(...);
    }
    
    // 3. Retornar resultado
    return ['status' => 200, 'message' => '...'];
}
```

## âœ… Validaciones

### Frontend
- âœ… Al menos 1 anuncio requerido
- âœ… Nombre de anuncio obligatorio
- âœ… Fechas vÃ¡lidas
- âœ… ConfirmaciÃ³n antes de eliminar

### Backend
- âœ… ValidaciÃ³n de datos de campaÃ±a
- âœ… ValidaciÃ³n de cada anuncio
- âœ… Manejo de errores por anuncio
- âœ… Contador de anuncios creados

## ğŸ¯ Ventajas del DiseÃ±o

1. **Visual Intuitivo:**
   - DiseÃ±o tipo tarjetas
   - SeparaciÃ³n clara entre campaÃ±a y anuncios
   - Iconos descriptivos

2. **Flexibilidad:**
   - Agregar/eliminar anuncios dinÃ¡micamente
   - Sin lÃ­mite de anuncios
   - ValidaciÃ³n individual

3. **Experiencia de Usuario:**
   - Drag & drop para imÃ¡genes
   - Preview inmediato
   - Feedback visual
   - Botones de acciÃ³n claros

4. **Responsive:**
   - 2 columnas en desktop
   - 1 columna en mÃ³vil
   - Adaptable a cualquier pantalla

## ğŸ§ª Pruebas Recomendadas

1. **Agregar Anuncios:**
   - Click en [+]
   - Verificar que se agrega nueva tarjeta
   - Verificar contador (Pauta 3, 4, 5...)

2. **Eliminar Anuncios:**
   - Click en [Eliminar]
   - Verificar que se elimina tarjeta
   - Intentar eliminar Ãºltimo anuncio (debe fallar)

3. **Subir ImÃ¡genes:**
   - Click en Ã¡rea de imagen
   - Seleccionar archivo
   - Verificar preview
   - Verificar conversiÃ³n a base64

4. **Validar Anuncios:**
   - Click en [Actualizar]
   - Dejar nombre vacÃ­o (debe fallar)
   - Llenar nombre (debe pasar)

5. **Guardar CampaÃ±a:**
   - Llenar todos los campos
   - Click en [Guardar CampaÃ±a]
   - Verificar creaciÃ³n en BD
   - Verificar mÃºltiples anuncios

## ğŸ“ Notas TÃ©cnicas

### Manejo de ImÃ¡genes
- Se usa `FileReader` para convertir a base64
- Se almacena en campo oculto `ad-image-url`
- Se envÃ­a como string al backend
- Backend puede guardar en servidor o BD

### Contador DinÃ¡mico
```javascript
let adCounter = 2;  // Inicia en 2 (ya hay 2 tarjetas)
$('#btnAddAd').on('click', () => {
    adCounter++;  // Incrementa
    // Usa adCounter para "Pauta X"
});
```

### Fechas por Defecto
```javascript
const firstDay = new Date(year, month, 1);      // DÃ­a 01
const fifteenthDay = new Date(year, month, 15); // DÃ­a 15
```

## ğŸ”„ Diferencias con VersiÃ³n Anterior

| Aspecto | Antes | Ahora |
|---------|-------|-------|
| DiseÃ±o | Formulario vertical simple | Tarjetas en grid 2 columnas |
| Anuncios | 1 anuncio por vez | MÃºltiples anuncios simultÃ¡neos |
| ImÃ¡genes | Input URL | Drag & drop con preview |
| ValidaciÃ³n | Al final | Individual por anuncio |
| Flexibilidad | Fija | DinÃ¡mica (agregar/eliminar) |
| Visual | BÃ¡sico | Profesional con tarjetas |

---

**Estado**: âœ… DISEÃ‘O VISUAL IMPLEMENTADO  
**Fecha**: 2025  
**Desarrollado con**: CoffeeIA â˜•
